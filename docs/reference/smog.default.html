<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Generalized linear model constraint on hierarchical structure
by using overlapped group penalty — smog.default • smog</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>


  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Generalized linear model constraint on hierarchical structure
by using overlapped group penalty — smog.default" />
<meta property="og:description" content="smog fits a linear non-penalized phynotype (demographic) variables such as
age, gender, treatment, etc, and penalized groups of prognostic effect (main effect)
and predictive effect (interaction effect), by satisfying the hierarchy structure:
if a predictive effect exists, its prognostic effect must be in the model. It can deal
with continuous, binomial or multinomial, and survival response variables, underlying
the assumption of Gaussian, binomial (multinomial), and Cox proportional hazard models,
respectively. It can accept formula, and output coefficients table,
fitted.values, and convergence information produced in the algorithm iterations." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-0000000-01"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-0000000-01');
</script>


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">smog</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="fa fa-pencil-square-o"></span>
     
    Update
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/chongma8903/smog/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generalized linear model constraint on hierarchical structure
by using overlapped group penalty</h1>
    <small class="dont-index">Source: <a href='https://github.com/chongma8903/smog/blob/master/R/smog.R'><code>R/smog.R</code></a></small>
    <div class="hidden name"><code>smog.default.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>smog</code> fits a linear non-penalized phynotype (demographic) variables such as
age, gender, treatment, etc, and penalized groups of prognostic effect (main effect)
and predictive effect (interaction effect), by satisfying the hierarchy structure:
if a predictive effect exists, its prognostic effect must be in the model. It can deal
with continuous, binomial or multinomial, and survival response variables, underlying
the assumption of Gaussian, binomial (multinomial), and Cox proportional hazard models,
respectively. It can accept <code><a href='https://rdrr.io/r/stats/formula.html'>formula</a></code>, and output coefficients table,
fitted.values, and convergence information produced in the algorithm iterations.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for default</span>
<span class='fu'><a href='smog.html'>smog</a></span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='no'>g</span>, <span class='no'>v</span>, <span class='no'>label</span>, <span class='no'>lambda1</span>, <span class='no'>lambda2</span>, <span class='no'>lambda3</span>,
  <span class='kw'>family</span> <span class='kw'>=</span> <span class='st'>"gaussian"</span>, <span class='kw'>subset</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>rho</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>eabs</span> <span class='kw'>=</span> <span class='fl'>0.001</span>, <span class='kw'>erel</span> <span class='kw'>=</span> <span class='fl'>0.001</span>, <span class='kw'>LL</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>eta</span> <span class='kw'>=</span> <span class='fl'>1.25</span>, <span class='kw'>maxitr</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
  <span class='no'>...</span>)

<span class='co'># S3 method for formula</span>
<span class='fu'><a href='smog.html'>smog</a></span>(<span class='no'>formula</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(), <span class='no'>g</span>, <span class='no'>v</span>, <span class='no'>label</span>, <span class='no'>lambda1</span>,
  <span class='no'>lambda2</span>, <span class='no'>lambda3</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a model matrix, or a data frame of dimensions n by p,
in which the columns represents the predictor variables.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>response variable, corresponds to the family description.
When family is ''gaussian'' or ''binomial'', <code>y</code> ought to
be a numeric vector of observations of length n; when family
is ''coxph'', <code>y</code> represents the survival objects, containing the
survival time and the censoring status. See <code><a href='https://rdrr.io/pkg/survival/man/Surv.html'>Surv</a></code>.</p></td>
    </tr>
    <tr>
      <th>g</th>
      <td><p>a vector of group labels for the predictor variables.</p></td>
    </tr>
    <tr>
      <th>v</th>
      <td><p>a vector of binary values, represents whether or not the
predictor variables are penalized. Note that 1 indicates
penalization and 0 for not penalization.</p></td>
    </tr>
    <tr>
      <th>label</th>
      <td><p>a character vector, represents the type of predictors in terms of treatment,
prognostic, and predictive effects by using ''t'', ''prog'', and ''pred'',
respectively.</p></td>
    </tr>
    <tr>
      <th>lambda1</th>
      <td><p>penalty parameter for the L2 norm of each group of prognostic and predictive effects.</p></td>
    </tr>
    <tr>
      <th>lambda2</th>
      <td><p>ridge penalty parameter for the squared L2 norm of each group of prognostic and predictive effects.</p></td>
    </tr>
    <tr>
      <th>lambda3</th>
      <td><p>penalty parameter for the L1 norm of predictive effects.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>a description of the distribution family for the response
variable variable. For continuous response variable,
family is ''gaussian''; for multinomial or binary response
variable, family is ''binomial''; for survival response
variable, family is ''coxph'', respectively.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>an optional vector specifying a subset of observations to be
used in the model fitting. Default is <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>rho</th>
      <td><p>the penalty parameter used in the alternating direction method
of multipliers (ADMM) algorithm. Default is 10.</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>whether or not scale the design matrix. Default is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>eabs</th>
      <td><p>the absolute tolerance used in the ADMM algorithm. Default is 1e-3.</p></td>
    </tr>
    <tr>
      <th>erel</th>
      <td><p>the reletive tolerance used in the ADMM algorithm. Default is 1e-3.</p></td>
    </tr>
    <tr>
      <th>LL</th>
      <td><p>initial value for the Lipschitz continuous constant for
approximation to the objective function in the Majorization-
Minimization (MM) (or iterative shrinkage-thresholding algorithm
(ISTA)). Default is 1.</p></td>
    </tr>
    <tr>
      <th>eta</th>
      <td><p>gradient stepsize for the backtrack line search for the Lipschitz
continuous constant. Default is 1.25.</p></td>
    </tr>
    <tr>
      <th>maxitr</th>
      <td><p>the maximum iterations for convergence in the ADMM algorithm.
Default is 1000.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other relevant arguments that can be supplied to smog.</p></td>
    </tr>
    <tr>
      <th>formula</th>
      <td><p>an object of class ''formula'': a symbolic description of the
model to be fitted. Should not include the intercept.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>an optional data frame, containing the variables in the model.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>smog</code> returns an object of class inhering from ''smog''. The
generic accessor functions <code>coef</code>, <code>coefficients</code>,
<code>fitted.value</code>, and <code>predict</code> can be used to extract
various useful features of the value returned by <code>smog</code>.
An object of ''smog'' is a list containing at least the following
components:</p><h3></h3>

<dl class='dl-horizontal'>
<dt>coefficients</dt><dd><p>Data frame containing the nonzero predictor
variables' indexes, names, and estimates. When
family is ''binomial'', the estimates have K-1
columns, each column representing the weights for the
corresponding group. The last group behaves the
''pivot''.</p></dd>
<dt>fitted.values</dt><dd><p>The fitted mean values for the response variable,
for family is ''gaussian''. When family is
''binomial", the fitted.values are the probabilies
for each class; when family is ''coxph'',
the fitted.values are risk scores.</p></dd>
<dt>residuals</dt><dd><p>The residual is trivial for family = "gaussian".
For family = "binomial", Pearson residuals is returned; and
for family = "coxph", it yields deviance residuals, i.e.,
standardized martingale residuals.</p></dd>
<dt>model</dt><dd><p>A list of estimates for the intercept, treatment effect,
and prognostic and predictive effects for the selectd
biomarkers.</p></dd>
<dt>weight</dt><dd><p>The weight of predictors resulted from the penalty funciton,
is used to calculate the degrees of freedom.</p></dd>
<dt>DF</dt><dd><p>the degrees of freedom. When family = ''gaussian'',
\(DF = tr(x_{\lambda}'(x_{\lambda}'x_{\lambda}+W)x_{\lambda})\).
For other families, DF is approximated by \(diag(1/(1+W))\).</p></dd>
<dt>criteria</dt><dd><p>model selection criteria, including the correction Akaike's Information
Criterion (AIC), AIC, Bayesian Information Criterion (BIC), and the generalized
cross-validation score (GCV), respectively. See also <code><a href='cv.smog.html'>cv.smog</a></code>.</p></dd>
<dt>llikelihood</dt><dd><p>the log-likelihood value for the converged model.</p></dd>
<dt>loglike</dt><dd><p>the penalized log-likelihood values for each
iteration in the algorithm.</p></dd>
<dt>PrimalError</dt><dd><p>the averged norms \(||\beta-Z||/\sqrt{p}\) for each iteration,
in the ADMM algorithm.</p></dd>
<dt>DualError</dt><dd><p>the averaged norms \(||Z^{t+1}-Z^{t}||/\sqrt{p}\) for
each iteration, in the ADMM algorithm.</p></dd>
<dt>converge</dt><dd><p>the number of iterations processed in the ADMM algorithm.</p></dd>
<dt>call</dt><dd><p>the matched call.</p></dd>
<dt>formula</dt><dd><p>the formula supplied.</p></dd>

</dl>


    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The formula has the form <code>response ~ 0 + terms</code> where <code>terms</code> is
a series of predictor variables to be fitted for <code>response</code>. For <code>gaussian</code>
family, the response is a continuous vector. For <code>binomial</code> family,
the response is a factor vector, in which the last level denotes the ''pivot''.
For <code>coxph</code> family, the response is a <code><a href='https://rdrr.io/pkg/survival/man/Surv.html'>Surv</a></code>
object, containing the survival time and censoring status.</p>
    <h2 class="hasAnchor" id="penalized-regression-model"><a class="anchor" href="#penalized-regression-model"></a>Penalized regression model</h2>

    <p>The regression function contains the non-penalized predictor variables,
and many groups of prognostic and predictive terms, where in each group the prognostic term comes first,
followed by the predictive term.</p><ul>
<li><p><code>Penalty function</code>: Different hierachical structures within groups can result from adjusting
the penalty parameters in the penalty function:</p>
<p>$$\Omega(\mathbf{\beta}) = \lambda_1||\mathbf{\beta}|| + \lambda_2||\mathbf{\beta}||^2+\lambda_3|\beta_2|$$</p>
<p>Where \(\mathbf{\beta}=(\beta_1,\beta_2)\). Note that \(\beta_1\) denotes the prognostic effect
(main effect), and \(\beta_2\) for the predictive effect (interactive effect), respectively.
When \(\lambda_2 = 0\) and \(\lambda_3 = 0\), it indicates no structure within groups. When
\(\lambda_2 \ne 0\), the penalty function honors the structure within groups such that:
predictive effect \(\ne 0 \Longrightarrow\) prognostic effect \(\ne 0\).</p></li>
<li><p><code>Tuning parameters</code>: <code>rho,eabs,erel,LL,eta</code> are the corresponding parameters used in the
itervative shrinkage-thresholding algorithm (ISTA) and the alternating direction method of
multipliers algorithm (ADMM).</p></li>
</ul>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Ma C, Deng W, Ma S, Liu R, Galinsky K (2019).
&#8220;Structural modeling using overlapped group penalties for discovering predictive biomarkers for subgroup analysis.&#8221;
<em>arXiv preprint arXiv:1904.11648</em>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='cv.smog.html'>cv.smog</a></code>, <code><a href='predict.smog.html'>predict.smog</a></code>, <code><a href='plot.smog.html'>plot.smog</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>

<span class='no'>n</span><span class='kw'>=</span><span class='fl'>100</span>;<span class='no'>p</span><span class='kw'>=</span><span class='fl'>20</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>2018</span>)
<span class='co'># generate design matrix x</span>
<span class='no'>s</span><span class='kw'>=</span><span class='fl'>10</span>
<span class='no'>x</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fl'>0</span>,<span class='no'>n</span>,<span class='fl'>1</span>+<span class='fl'>2</span>*<span class='no'>p</span>)
<span class='no'>x</span>[,<span class='fl'>1</span>]<span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>),<span class='no'>n</span>,<span class='kw'>replace</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>x</span>[,<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>2</span>,<span class='fl'>1</span>+<span class='fl'>2</span>*<span class='no'>p</span>,<span class='fl'>2</span>)]<span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span>*<span class='no'>p</span>),<span class='no'>n</span>,<span class='no'>p</span>)
<span class='no'>x</span>[,<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>3</span>,<span class='fl'>1</span>+<span class='fl'>2</span>*<span class='no'>p</span>,<span class='fl'>2</span>)]<span class='kw'>=</span><span class='no'>x</span>[,<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>2</span>,<span class='fl'>1</span>+<span class='fl'>2</span>*<span class='no'>p</span>,<span class='fl'>2</span>)]*<span class='no'>x</span>[,<span class='fl'>1</span>]

<span class='no'>g</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>p</span>+<span class='fl'>1</span>,<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='no'>p</span>,<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>2</span>,<span class='no'>p</span>)))  <span class='co'># groups </span>
<span class='no'>v</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>*<span class='no'>p</span>))           <span class='co'># penalization status</span>
<span class='no'>label</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"t"</span>,<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"prog"</span>,<span class='st'>"pred"</span>),<span class='no'>p</span>))  <span class='co'># type of predictor variables</span>

<span class='co'># generate beta</span>
<span class='no'>beta</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>13</span>,<span class='fl'>0</span>,<span class='fl'>2</span>),<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0</span>,<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>x</span>)-<span class='fl'>13</span>))
<span class='no'>beta</span>[<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>4</span>,<span class='fl'>7</span>,<span class='fl'>9</span>)]<span class='kw'>=</span><span class='fl'>0</span>

<span class='co'># generate y</span>
<span class='no'>data1</span><span class='kw'>=</span><span class='no'>x</span><span class='kw'>%*%</span><span class='no'>beta</span>
<span class='no'>noise1</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span>)
<span class='no'>snr1</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>var</a></span>(<span class='no'>data1</span>)/(<span class='no'>s</span>*<span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>var</a></span>(<span class='no'>noise1</span>))))
<span class='no'>y1</span><span class='kw'>=</span><span class='no'>data1</span>+<span class='no'>snr1</span>*<span class='no'>noise1</span>
<span class='no'>lfit1</span><span class='kw'>=</span><span class='fu'><a href='smog.html'>smog</a></span>(<span class='no'>x</span>,<span class='no'>y1</span>,<span class='no'>g</span>,<span class='no'>v</span>,<span class='no'>label</span>,<span class='kw'>lambda1</span><span class='kw'>=</span><span class='fl'>8</span>,<span class='kw'>lambda2</span><span class='kw'>=</span><span class='fl'>0</span>,<span class='kw'>lambda3</span><span class='kw'>=</span><span class='fl'>8</span>,<span class='kw'>family</span> <span class='kw'>=</span> <span class='st'>"gaussian"</span>)

<span class='co'>## generate binomial data</span>
<span class='no'>prob</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>x</span>)<span class='kw'>%*%</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>beta</span>))/(<span class='fl'>1</span>+<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>x</span>)<span class='kw'>%*%</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>beta</span>)))
<span class='no'>y2</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='no'>prob</span><span class='kw'>&lt;</span><span class='fl'>0.5</span>,<span class='fl'>0</span>,<span class='fl'>1</span>)
<span class='no'>lfit2</span><span class='kw'>=</span><span class='fu'><a href='smog.html'>smog</a></span>(<span class='no'>x</span>,<span class='no'>y2</span>,<span class='no'>g</span>,<span class='no'>v</span>,<span class='no'>label</span>,<span class='kw'>lambda1</span><span class='kw'>=</span><span class='fl'>0.03</span>,<span class='kw'>lambda2</span><span class='kw'>=</span><span class='fl'>0</span>,<span class='kw'>lambda3</span><span class='kw'>=</span><span class='fl'>0.03</span>,<span class='kw'>family</span> <span class='kw'>=</span> <span class='st'>"binomial"</span>)

<span class='co'>## generate survival data</span>
<span class='co'># Weibull latent event times</span>
<span class='no'>lambda</span> <span class='kw'>=</span> <span class='fl'>0.01</span>; <span class='no'>rho</span> <span class='kw'>=</span> <span class='fl'>1</span>
<span class='no'>V</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n</span>)
<span class='no'>Tlat</span> <span class='kw'>=</span> (- <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='no'>V</span>) / (<span class='no'>lambda</span>*<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(<span class='no'>x</span> <span class='kw'>%*%</span> <span class='no'>beta</span>)) )^(<span class='fl'>1</span>/<span class='no'>rho</span>)
<span class='no'>C</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Exponential.html'>rexp</a></span>(<span class='no'>n</span>, <span class='fl'>0.001</span>)  <span class='co'>## censoring time</span>
<span class='no'>time</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>as.vector</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>pmin</a></span>(<span class='no'>Tlat</span>, <span class='no'>C</span>))
<span class='no'>status</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span>(<span class='no'>Tlat</span> <span class='kw'>&lt;=</span> <span class='no'>C</span>)
<span class='no'>y3</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='kw'>time</span> <span class='kw'>=</span> <span class='no'>time</span>, <span class='kw'>status</span> <span class='kw'>=</span> <span class='no'>status</span>))

<span class='no'>lfit3</span><span class='kw'>=</span><span class='fu'><a href='smog.html'>smog</a></span>(<span class='no'>x</span>,<span class='no'>y3</span>,<span class='no'>g</span>,<span class='no'>v</span>,<span class='no'>label</span>,<span class='kw'>lambda1</span><span class='kw'>=</span><span class='fl'>0.2</span>,<span class='kw'>lambda2</span><span class='kw'>=</span><span class='fl'>0</span>,<span class='kw'>lambda3</span><span class='kw'>=</span><span class='fl'>0.2</span>,<span class='kw'>family</span> <span class='kw'>=</span> <span class='st'>"coxph"</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#penalized-regression-model">Penalized regression model</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Chong Ma, <a href='mailto:chongma8903@gmail.com'>chongma8903@gmail.com</a>.</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Chong Ma.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: 'API_KEY',
    indexName: 'INDEX_NAME',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


